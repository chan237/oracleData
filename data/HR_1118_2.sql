--순위함수 RANK(), DENSE_RANK(), ROWNUM()
DROP TABLE EMP02;
CREATE TABLE EMP02
AS
SELECT * FROM EMPLOYEES WHERE 1=1;
SELECT * FROM EMP02;

--ROWNUM으로 순위구하기, 공동순위 없음, 게시판에서 많이쓰임
SELECT ROWNUM, FIRST_NAME, SALARY FROM EMPLOYEES ORDER BY SALARY DESC;
SELECT ROWNUM, FIRST_NAME, SALARY FROM (SELECT FIRST_NAME, SALARY FROM EMPLOYEES ORDER BY SALARY DESC);

SELECT RANK() OVER(ORDER BY SALARY DESC) AS RANK , FIRST_NAME, SALARY FROM EMPLOYEES ORDER BY SALARY DESC;

SELECT RANK() OVER(ORDER BY SALARY DESC) AS RANK , DENSE_RANK() OVER(ORDER BY SALARY DESC) AS DENSE_RANK 
, FIRST_NAME, SALARY FROM EMPLOYEES ORDER BY SALARY DESC;

--순위 구하는 법
SELECT RNUM, FIRST_NAME, SALARY FROM (SELECT ROWNUM AS RNUM, E.*FROM EMPLOYEES E)
WHERE RNUM BETWEEN 100 AND 110;

SELECT RNUM, FIRST_NAME, SALARY FROM (SELECT ROWNUM AS RNUM, E.*FROM EMPLOYEES E WHERE ROWNUM <=110)
WHERE RNUM >= 100;